"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8301],{7502:function(e,n,t){t.d(n,{Z:function(){return I}});var a=t(9783),r=t.n(a),i=t(5574),l=t.n(i),s=t(33623),o=t(7306),c=t(86968),d=t(22850),u=t(4393),m=t(22150),p=t(84567),h=t(34041),f=t(85576),x=t(92398),v=t(62435),j=t(98236),g=t(40169),b=t(27080),y="codeCard___TMIpT",Z="id___EtPCm",_="darkId___ASEvo",k=t(86074),w=d.Z.Paragraph,C=d.Z.Link,I=function(e){var n,t=e.visible,a=e.hideModal,i=e.token,d=void 0===i?"":i,I=e.form,E=e.beta,P=void 0===E?"":E,N=e.isAgent,S=(0,c.qM)("chat").t,M=(0,j.e5)(),T=(0,v.useState)(!1),A=l()(T,2),F=A[0],O=A[1],V=(0,v.useState)(""),q=l()(V,2),D=q[0],L=q[1],R=(0,v.useMemo)((function(){return Object.values(g.O2).map((function(e){return{label:g.Tt[e],value:e}}))}),[]),B=(n="".concat(location.origin,"/chat/share?shared_id=").concat(d,"&from=").concat(I,"&auth=").concat(P),F&&(n+="&visible_avatar=1"),D&&(n+="&locale=".concat(D)),n),H='\n  ~~~ html\n  <iframe\n  src="'.concat(B,'"\n  style="width: 100%; height: 100%; min-height: 600px"\n  frameborder="0"\n>\n</iframe>\n~~~\n  '),z=[{key:"1",label:S("fullScreenTitle"),children:(0,k.jsxs)(u.Z,{title:S("fullScreenDescription"),extra:(0,k.jsx)(s.Z,{text:H}),className:y,children:[(0,k.jsxs)("div",{className:"p-2",children:[(0,k.jsx)("h2",{className:"mb-3",children:"Option:"}),(0,k.jsx)(m.Z.Item,{label:S("avatarHidden"),labelCol:{span:6},wrapperCol:{span:18},children:(0,k.jsx)(p.Z,{checked:F,onChange:function(e){return O(e.target.checked)}})}),(0,k.jsx)(m.Z.Item,{label:S("locale"),labelCol:{span:6},wrapperCol:{span:18},children:(0,k.jsx)(h.Z,{placeholder:"Select a locale",onChange:function(e){return L(e)},options:R,style:{width:"100%"}})})]}),(0,k.jsx)(o.Z,{children:H})]})},{key:"2",label:S("partialTitle"),children:S("comingSoon")},{key:"3",label:S("extensionTitle"),children:S("comingSoon")}];return(0,k.jsxs)(f.Z,{title:S("embedIntoSite",{keyPrefix:"common"}),open:t,style:{top:300},width:"50vw",onOk:a,onCancel:a,children:[(0,k.jsx)(x.Z,{defaultActiveKey:"1",items:z,onChange:function(e){console.log(e)}}),(0,k.jsxs)("div",{className:"text-base font-medium mt-4 mb-1",children:[S(N?"flow":"chat",{keyPrefix:"header"}),(0,k.jsx)("span",{className:"ml-1 inline-block",children:"ID"})]}),(0,k.jsx)(w,{copyable:{text:d},className:(0,b.cn)(Z,r()({},_,M)),children:d}),(0,k.jsx)(C,{href:N?"https://ragflow.io/docs/dev/http_api_reference#create-session-with-agent":"https://ragflow.io/docs/dev/http_api_reference#create-session-with-chat-assistant",target:"_blank",children:S("howUseId",{keyPrefix:N?"flow":"chat"})})]})}},5600:function(e,n,t){t.d(n,{Xm:function(){return v},iV:function(){return x},r6:function(){return h}});var a=t(15009),r=t.n(a),i=t(99289),l=t.n(i),s=t(9783),o=t.n(s),c=t(1079),d=t(86968),u=t(39259),m=t(45360),p=t(62435),h=function(e,n){var t=(0,u.ef)().removeToken,a=(0,u.PI)(),r=a.createToken,i=a.loading,l=(0,u.F1)(),s=l.data,c=l.loading,m=(0,d.I3)();return{removeToken:function(e){m({onOk:function(){return t(e)}})},createToken:(0,p.useCallback)((function(){r(o()({},e,n))}),[r,e,n]),tokenList:s,creatingLoading:i,listLoading:c}},f=function(){var e,n=(e=(0,d.qM)("chat").t,{showTokenEmptyError:(0,p.useCallback)((function(){m.ZP.error(e("tokenError"))}),[e])}).showTokenEmptyError,t=function(){var e=(0,d.qM)("chat").t;return{showBetaEmptyError:(0,p.useCallback)((function(){m.ZP.error(e("betaError"))}),[e])}}(),a=t.showBetaEmptyError,i=(0,u.v)(),s=i.data,o=i.fetchSystemTokenList,c="";return Array.isArray(s)&&s.length>0&&(s[0].token,c=s[0].beta),{token:Array.isArray(s)&&s.length>0?s[0].token:"",beta:c,handleOperate:(0,p.useCallback)(l()(r()().mark((function e(){var t,i,l;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:if(t=e.sent,i=t,!(Array.isArray(i)&&i.length>0)){e.next=11;break}if(i[0].beta){e.next=8;break}return a(),e.abrupt("return",!1);case 8:return e.abrupt("return",null===(l=i[0])||void 0===l?void 0:l.token);case 11:return n(),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)}))),[o,a,n])}},x=function(){var e=(0,d.pG)(),n=e.visible,t=e.hideModal,a=e.showModal,i=f(),s=i.handleOperate,o=i.token,c=i.beta;return{showEmbedModal:(0,p.useCallback)(l()(r()().mark((function e(){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:e.sent&&a();case 4:case"end":return e.stop()}}),e)}))),[s,a]),hideEmbedModal:t,embedVisible:n,embedToken:o,beta:c}},v=function(e){var n=f().handleOperate,t=(0,p.useCallback)((function(n){window.open(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chat",t=window.location,a=t.protocol,r=t.host;return"".concat(a,"//").concat(r,"/chat/share?shared_id=").concat(e,"&from=").concat(n)}(n,"canvasId"===e?c.qH.Agent:c.qH.Chat),"_blank")}),[e]);return{handlePreview:(0,p.useCallback)(l()(r()().mark((function e(){var a;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:(a=e.sent)&&t(a);case 4:case"end":return e.stop()}}),e)}))),[n,t])}}},58057:function(e,n,t){t.d(n,{Z:function(){return C}});var a=t(19632),r=t.n(a),i=t(97857),l=t.n(i),s=t(9783),o=t.n(s),c=t(96330),d=t(22150),u=t(34041),m=t(83062),p=t(86250),h=t(72269),f=t(71338),x=t(48928),v=t(68929),j=t.n(v),g=t(86968),b=t(38392),y=t(25035),Z=t(62435),_="sliderInputNumber___ZMqQO",k="variableSlider___MglII",w=t(86074),C=function(e){var n=e.prefix,t=e.formItemLayout,a=void 0===t?{}:t,i=d.Z.useFormInstance(),s=(0,g.qM)("chat").t,v=Object.values(c.oQ).map((function(e){return{label:s(j()(e)),value:e}})),C=(0,Z.useCallback)((function(e){var t=c.S8[e],a=t;n&&(a=o()({},n,t)),i.setFieldsValue(a)}),[i,n]),I=(0,Z.useMemo)((function(){return n?[n]:[]}),[n]),E=(0,b.T)([c.Vr.Chat,c.Vr.Image2text]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(d.Z.Item,l()(l()({label:s("model"),name:"llm_id",tooltip:s("modelTip")},a),{},{rules:[{required:!0,message:s("modelMessage")}],children:(0,w.jsx)(u.Z,{options:E,showSearch:!0,popupMatchSelectWidth:!1})})),(0,w.jsxs)("div",{className:"border rounded-md",children:[(0,w.jsxs)("div",{className:"flex justify-between bg-slate-100 p-2 mb-2",children:[(0,w.jsxs)("div",{className:"space-x-1 items-center",children:[(0,w.jsx)("span",{className:"text-lg font-semibold",children:s("freedom")}),(0,w.jsx)(m.Z,{title:s("freedomTip"),children:(0,w.jsx)(y.Z,{})})]}),(0,w.jsx)("div",{className:"w-1/4 min-w-32",children:(0,w.jsx)(d.Z.Item,{label:s("freedom"),name:"parameter",tooltip:s("freedomTip"),initialValue:c.oQ.Precise,labelCol:{span:0},wrapperCol:{span:24},className:"m-0",children:(0,w.jsx)(u.Z,{options:v,onChange:C})})})]}),(0,w.jsxs)("div",{className:"pr-2",children:[(0,w.jsx)(d.Z.Item,l()(l()({label:s("temperature"),tooltip:s("temperatureTip")},a),{},{children:(0,w.jsxs)(p.Z,{gap:20,align:"center",children:[(0,w.jsx)(d.Z.Item,{name:"temperatureEnabled",valuePropName:"checked",noStyle:!0,children:(0,w.jsx)(h.Z,{size:"small"})}),(0,w.jsx)(d.Z.Item,{noStyle:!0,dependencies:["temperatureEnabled"],children:function(e){var n=!(0,e.getFieldValue)("temperatureEnabled");return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Z,{flex:1,children:(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["temperature"]),noStyle:!0,children:(0,w.jsx)(f.Z,{className:k,max:1,step:.01,disabled:n})})}),(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["temperature"]),noStyle:!0,children:(0,w.jsx)(x.Z,{className:_,max:1,min:0,step:.01,disabled:n})})]})}})]})})),(0,w.jsx)(d.Z.Item,l()(l()({label:s("topP"),tooltip:s("topPTip")},a),{},{children:(0,w.jsxs)(p.Z,{gap:20,align:"center",children:[(0,w.jsx)(d.Z.Item,{name:"topPEnabled",valuePropName:"checked",noStyle:!0,children:(0,w.jsx)(h.Z,{size:"small"})}),(0,w.jsx)(d.Z.Item,{noStyle:!0,dependencies:["topPEnabled"],children:function(e){var n=!(0,e.getFieldValue)("topPEnabled");return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Z,{flex:1,children:(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["top_p"]),noStyle:!0,children:(0,w.jsx)(f.Z,{className:k,max:1,step:.01,disabled:n})})}),(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["top_p"]),noStyle:!0,children:(0,w.jsx)(x.Z,{className:_,max:1,min:0,step:.01,disabled:n})})]})}})]})})),(0,w.jsx)(d.Z.Item,l()(l()({label:s("presencePenalty"),tooltip:s("presencePenaltyTip")},a),{},{children:(0,w.jsxs)(p.Z,{gap:20,align:"center",children:[(0,w.jsx)(d.Z.Item,{name:"presencePenaltyEnabled",valuePropName:"checked",noStyle:!0,children:(0,w.jsx)(h.Z,{size:"small"})}),(0,w.jsx)(d.Z.Item,{noStyle:!0,dependencies:["presencePenaltyEnabled"],children:function(e){var n=!(0,e.getFieldValue)("presencePenaltyEnabled");return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Z,{flex:1,children:(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["presence_penalty"]),noStyle:!0,children:(0,w.jsx)(f.Z,{className:k,max:1,step:.01,disabled:n})})}),(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["presence_penalty"]),noStyle:!0,children:(0,w.jsx)(x.Z,{className:_,max:1,min:0,step:.01,disabled:n})})]})}})]})})),(0,w.jsx)(d.Z.Item,l()(l()({label:s("frequencyPenalty"),tooltip:s("frequencyPenaltyTip")},a),{},{children:(0,w.jsxs)(p.Z,{gap:20,align:"center",children:[(0,w.jsx)(d.Z.Item,{name:"frequencyPenaltyEnabled",valuePropName:"checked",noStyle:!0,children:(0,w.jsx)(h.Z,{size:"small"})}),(0,w.jsx)(d.Z.Item,{noStyle:!0,dependencies:["frequencyPenaltyEnabled"],children:function(e){var n=!(0,e.getFieldValue)("frequencyPenaltyEnabled");return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Z,{flex:1,children:(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["frequency_penalty"]),noStyle:!0,children:(0,w.jsx)(f.Z,{className:k,max:1,step:.01,disabled:n})})}),(0,w.jsx)(d.Z.Item,{name:[].concat(r()(I),["frequency_penalty"]),noStyle:!0,children:(0,w.jsx)(x.Z,{className:_,max:1,min:0,step:.01,disabled:n})})]})}})]})}))]})]})]})}},89545:function(e,n,t){var a=t(15009),r=t.n(a),i=t(99289),l=t.n(i),s=t(5574),o=t.n(s),c=t(86968),d=t(22150),u=t(85576),m=t(79531),p=t(62435),h=t(86074);n.Z=function(e){var n=e.visible,t=e.hideModal,a=e.loading,i=e.initialName,s=e.onOk,f=d.Z.useForm(),x=o()(f,1)[0],v=(0,c.qM)("common").t,j=function(){var e=l()(r()().mark((function e(){var n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.validateFields();case 2:return n=e.sent,e.abrupt("return",s(n.name));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,p.useEffect)((function(){n&&x.setFieldValue("name",i)}),[i,x,n]),(0,h.jsx)(u.Z,{title:v("rename"),open:n,onOk:j,onCancel:function(){t()},okButtonProps:{loading:a},confirmLoading:a,children:(0,h.jsx)(d.Z,{name:"basic",labelCol:{span:4},wrapperCol:{span:20},style:{maxWidth:600},onFinish:function(e){console.log("Success:",e)},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",form:x,children:(0,h.jsx)(d.Z.Item,{label:v("name"),name:"name",rules:[{required:!0,message:v("namePlaceholder")}],children:(0,h.jsx)(m.Z,{})})})})}},16772:function(e,n,t){t.d(n,{I:function(){return s}});var a=t(80499),r=t(2834),i=t(87536),l=t(86074);function s(e){var n=e.label,t=e.name,s=(0,i.Gc)();return(0,l.jsx)(a.Wi,{control:s.control,name:t,render:function(e){var t=e.field;return(0,l.jsxs)(a.xJ,{className:"flex justify-between",children:[(0,l.jsx)(a.lX,{className:"text-base",children:n}),(0,l.jsx)(a.NI,{children:(0,l.jsx)(r.r,{checked:t.value,onCheckedChange:t.onChange,"aria-readonly":!0,className:"!m-0"})})]})}})}},70125:function(e,n,t){t.d(n,{C:function(){return o},H:function(){return c}});var a=t(22150),r=t(72269),i=t(67421),l=t(16772),s=t(86074);function o(e){var n=e.filedName,t=(0,i.$G)().t;return(0,s.jsx)(a.Z.Item,{label:t("chat.useKnowledgeGraph"),tooltip:t("chat.useKnowledgeGraphTip"),name:n,initialValue:!1,children:(0,s.jsx)(r.Z,{})})}function c(e){var n=e.name,t=(0,i.$G)().t;return(0,s.jsx)(l.I,{name:n,label:t("chat.useKnowledgeGraph")})}},77778:function(e,n,t){t.r(n),t.d(n,{default:function(){return wn}});var a=t(9783),r=t.n(a),i=t(5574),l=t.n(i),s=t(62435),o=Object.defineProperty,c=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,m=(e,n,t)=>n in e?o(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const p=e=>s.createElement("svg",((e,n)=>{for(var t in n||(n={}))d.call(n,t)&&m(e,t,n[t]);if(c)for(var t of c(n))u.call(n,t)&&m(e,t,n[t]);return e})({width:15,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),s.createElement("path",{d:"m6.188 12.104.859.478c.165.092.248.138.335.156a.581.581 0 0 0 .236 0c.087-.018.17-.064.335-.156l.86-.478m-5.25-1.458-.833-.462c-.175-.097-.262-.146-.326-.215a.583.583 0 0 1-.125-.212c-.029-.09-.029-.19-.029-.39V8.46m0-2.917v-.91c0-.199 0-.299.03-.388a.583.583 0 0 1 .124-.212c.064-.07.151-.118.326-.215l.833-.463m2.624-1.458.86-.477c.165-.092.248-.138.335-.156a.583.583 0 0 1 .236 0c.087.018.17.064.335.156l.86.477m2.624 1.458.833.463c.175.097.262.146.326.215a.584.584 0 0 1 .125.212c.029.089.029.189.029.389v.909m0 2.917v.909c0 .2 0 .3-.03.389a.584.584 0 0 1-.124.212c-.064.07-.151.118-.326.215l-.832.462m-5.25-4.375 1.312.73m0 0 1.313-.73m-1.313.73v1.458M2.25 4.084l1.313.729m7.874 0 1.313-.73M7.5 11.376v1.459",stroke:"#A5A3A9",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}));var h=t(89545),f=t(86548),x=t(48689),v=t(22850),j=t(42075),g=t(86250),b=t(15867),y=t(96074),Z=t(75081),_=t(4393),k=t(7134),w=t(85418),C=t(66309),I=t(83062),E=t(93967),P=t.n(E),N=t(15009),S=t.n(N),M=t(97857),T=t.n(M),A=t(99289),F=t.n(A),O=Object.defineProperty,V=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,L=(e,n,t)=>n in e?O(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const R=e=>s.createElement("svg",((e,n)=>{for(var t in n||(n={}))q.call(n,t)&&L(e,t,n[t]);if(V)for(var t of V(n))D.call(n,t)&&L(e,t,n[t]);return e})({width:52,height:52,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),s.createElement("g",{filter:"url(#chat-configuration-atom_svg__a)"},s.createElement("path",{d:"M2.5 11A9.5 9.5 0 0 1 12 1.5h28a9.5 9.5 0 0 1 9.5 9.5v28a9.5 9.5 0 0 1-9.5 9.5H12A9.5 9.5 0 0 1 2.5 39V11Z",stroke:"#EAECF0",shapeRendering:"crispEdges"}),s.createElement("path",{d:"M26 25h.01m3.525 3.535c-4.686 4.686-10.068 6.903-12.02 4.95-1.953-1.953.263-7.335 4.949-12.02 4.686-4.687 10.068-6.903 12.02-4.95 1.953 1.952-.263 7.334-4.949 12.02Zm0-7.071c4.686 4.686 6.902 10.068 4.95 12.02-1.953 1.953-7.335-.263-12.021-4.949-4.686-4.686-6.902-10.068-4.95-12.02 1.953-1.953 7.335.263 12.021 4.949ZM26.5 25a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z",stroke:"#344054",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),s.createElement("defs",null,s.createElement("filter",{id:"chat-configuration-atom_svg__a",x:0,y:0,width:52,height:52,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dy:1}),s.createElement("feGaussianBlur",{stdDeviation:1}),s.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),s.createElement("feColorMatrix",{values:"0 0 0 0 0.0627451 0 0 0 0 0.0941176 0 0 0 0 0.156863 0 0 0 0.05 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_550_8026"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_550_8026",result:"shape"}))));var B=t(96330),H=t(86968),z=t(2938),G=t(51331),W=t(51418),K=t(22150),U=t(85576),$=t(92783),X=t(68929),Q=t.n(X),Y=t(91929),J=t(39259),ee=t(24969),ne=t(45360),te=t(79531),ae=t(84553),re=t(34041),ie=t(72269),le="chatConfigurationDescription___Marto",se="variableContainer___Y8OCn",oe="variableAlign___V0wtR",ce="variableLabel___lux8o",de="variableIcon___aAfD2",ue="variableTable___q3ddB",me="editableRow____LyFZ",pe="segmentedHidden___jWNN7",he=t(86074),fe=["prompt_config","empty_response"],xe=function(e){var n=e.show,t=e.form,a=e.setHasError,i=(0,H.qM)("chat").t,l=(0,J.fS)(!0).data,o=(0,s.useCallback)((function(){var e=t.getFieldValue("kb_ids"),n=t.getFieldValue(fe)&&(Array.isArray(e)&&0===e.length||!e);a(n),t.setFields([{name:fe,errors:n?[i("emptyResponseMessage")]:[]}])}),[t,a,i]),c=(0,s.useCallback)((function(e){e&&!l.tts_id&&(ne.ZP.error("Please set TTS model firstly. \n        Setting >> Model providers >> System model settings"),t.setFieldValue(["prompt_config","tts"],!1))}),[l,t]),d=(0,he.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[(0,he.jsx)(ee.Z,{}),(0,he.jsx)("div",{style:{marginTop:8},children:i("upload",{keyPrefix:"common"})})]});return(0,he.jsxs)("section",{className:P()(r()({},pe,!n)),children:[(0,he.jsx)(K.Z.Item,{name:"name",label:i("assistantName"),rules:[{required:!0,message:i("assistantNameMessage")}],children:(0,he.jsx)(te.Z,{placeholder:i("namePlaceholder")})}),(0,he.jsx)(K.Z.Item,{name:"description",label:i("description"),children:(0,he.jsx)(te.Z,{placeholder:i("descriptionPlaceholder")})}),(0,he.jsx)(K.Z.Item,{name:"icon",label:i("assistantAvatar"),valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},children:(0,he.jsx)(ae.Z,{listType:"picture-card",maxCount:1,beforeUpload:function(){return!1},showUploadList:{showPreviewIcon:!1,showRemoveIcon:!1},children:n?d:null})}),(0,he.jsx)(K.Z.Item,{name:"language",label:i("language"),initialValue:"English",tooltip:"coming soon",style:{display:"none"},children:(0,he.jsx)(re.Z,{options:[{value:"Chinese",label:i("chinese",{keyPrefix:"common"})},{value:"English",label:i("english",{keyPrefix:"common"})}]})}),(0,he.jsx)(K.Z.Item,{name:fe,label:i("emptyResponse"),tooltip:i("emptyResponseTip"),children:(0,he.jsx)(te.Z,{placeholder:"",onChange:o})}),(0,he.jsx)(K.Z.Item,{name:["prompt_config","prologue"],label:i("setAnOpener"),tooltip:i("setAnOpenerTip"),initialValue:i("setAnOpenerInitial"),children:(0,he.jsx)(te.Z.TextArea,{autoSize:{minRows:5}})}),(0,he.jsx)(K.Z.Item,{label:i("quote"),valuePropName:"checked",name:["prompt_config","quote"],tooltip:i("quoteTip"),initialValue:!0,children:(0,he.jsx)(ie.Z,{})}),(0,he.jsx)(K.Z.Item,{label:i("keyword"),valuePropName:"checked",name:["prompt_config","keyword"],tooltip:i("keywordTip"),initialValue:!1,children:(0,he.jsx)(ie.Z,{})}),(0,he.jsx)(K.Z.Item,{label:i("tts"),valuePropName:"checked",name:["prompt_config","tts"],tooltip:i("ttsTip"),initialValue:!1,children:(0,he.jsx)(ie.Z,{onChange:c})}),(0,he.jsx)(K.Z.Item,{label:"Tavily API Key",tooltip:i("tavilyApiKeyTip"),children:(0,he.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,he.jsx)(K.Z.Item,{name:["prompt_config","tavily_api_key"],noStyle:!0,children:(0,he.jsx)(te.Z.Password,{placeholder:i("tavilyApiKeyMessage")})}),(0,he.jsx)(v.Z.Link,{href:"https://app.tavily.com/home",target:"_blank",children:i("tavilyApiKeyHelp")})]})}),(0,he.jsx)(Y.Z,{required:!1,onChange:o})]})},ve=t(58057),je=t(1079),ge=t(71250),be=function(e){var n=e.show,t=e.form,a=e.initialLlmSetting,i=e.visible;return(0,s.useEffect)((function(){if(i){var e=Object.keys(je.vv).reduce((function(e,n){return e[n]=void 0===a?(0,ge.mV)(n):!!a[je.vv[n]],e}),{});t.setFieldsValue(e)}}),[t,a,i]),(0,he.jsx)("section",{className:P()(r()({},pe,!n)),children:i&&(0,he.jsx)(ve.Z,{prefix:"llm_setting"})})},ye=t(19632),Ze=t.n(ye),_e=t(32739),ke=t(25035),we=t(71230),Ce=t(15746),Ie=t(43106),Ee=t(57632),Pe=t(13769),Ne=t.n(Pe),Se=["index"],Me=["title","editable","children","dataIndex","record","handleSave"],Te=s.createContext(null),Ae=function(e){e.index;var n=Ne()(e,Se),t=K.Z.useForm(),a=l()(t,1)[0];return(0,he.jsx)(K.Z,{form:a,component:!1,children:(0,he.jsx)(Te.Provider,{value:a,children:(0,he.jsx)("tr",T()({},n))})})},Fe=function(e){var n=e.title,t=e.editable,a=e.children,i=e.dataIndex,o=e.record,c=e.handleSave,d=Ne()(e,Me),u=(0,s.useState)(!1),m=l()(u,2),p=m[0],h=m[1],f=(0,s.useRef)(null),x=(0,s.useContext)(Te);(0,s.useEffect)((function(){p&&f.current.focus()}),[p]);var v=function(){h(!p),x.setFieldsValue(r()({},i,o[i]))},j=function(){var e=F()(S()().mark((function e(){var n;return S()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.validateFields();case 3:n=e.sent,v(),c(T()(T()({},o),n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),g=a;return t&&(g=p?(0,he.jsx)(K.Z.Item,{style:{margin:0},name:i,rules:[{required:!0,message:"".concat(n," is required.")}],children:(0,he.jsx)(te.Z,{ref:f,onPressEnter:j,onBlur:j})}):(0,he.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:v,children:a})),(0,he.jsx)("td",T()(T()({},d),{},{children:g}))},Oe=t(77567),Ve=t(84676),qe=t(70125),De=t(41923),Le=function(e,n){var t=e.show,a=(0,s.useState)([]),i=l()(a,2),o=i[0],c=i[1],d=(0,De.GI)(),u=(0,H.qM)("chat").t,m={body:{row:Ae,cell:Fe}},p=function(e){var n=Ze()(o),t=n.findIndex((function(n){return e.key===n.key})),a=n[t];n.splice(t,1,T()(T()({},a),e)),c(n)},h=function(e){return function(n){var t=Ze()(o),a=t.findIndex((function(n){return e.key===n.key})),r=t[a];t.splice(a,1,T()(T()({},r),{},{optional:n})),c(t)}};(0,s.useImperativeHandle)(n,(function(){return o.filter((function(e){return""!==e.variable.trim()})).map((function(e){return{key:e.variable,optional:e.optional}}))}),[o]);var f=[{title:u("key"),dataIndex:"variable",key:"variable",onCell:function(e){return{record:e,editable:!0,dataIndex:"variable",title:"key",handleSave:p}}},{title:u("optional"),dataIndex:"optional",key:"optional",width:40,align:"center",render:function(e,n){return(0,he.jsx)(ie.Z,{size:"small",checked:e,onChange:h(n)})}},{title:u("operation"),dataIndex:"operation",width:30,key:"operation",align:"center",render:function(e,n){return(0,he.jsx)(x.Z,{onClick:(t=n.key,function(){var e=o.filter((function(e){return e.key!==t}));c(e)})});var t}}];return(0,s.useEffect)((function(){c(d)}),[d]),(0,he.jsxs)("section",{className:P()(r()({},pe,!t)),children:[(0,he.jsx)(K.Z.Item,{label:u("system"),rules:[{required:!0,message:u("systemMessage")}],tooltip:u("systemTip"),name:["prompt_config","system"],initialValue:u("systemInitialValue"),children:(0,he.jsx)(te.Z.TextArea,{autoSize:{maxRows:8,minRows:5}})}),(0,he.jsx)(y.Z,{}),(0,he.jsx)(_e.Z,{isTooltipShown:!0}),(0,he.jsx)(Ve.Z,{}),(0,he.jsx)(K.Z.Item,{label:u("multiTurn"),tooltip:u("multiTurnTip"),name:["prompt_config","refine_multiturn"],initialValue:!0,children:(0,he.jsx)(ie.Z,{})}),(0,he.jsx)(qe.C,{filedName:["prompt_config","use_kg"]}),(0,he.jsx)(K.Z.Item,{label:u("reasoning"),tooltip:u("reasoningTip"),name:["prompt_config","reasoning"],initialValue:!1,children:(0,he.jsx)(ie.Z,{})}),(0,he.jsx)(Oe.ZP,{}),(0,he.jsxs)("section",{className:P()(se),children:[(0,he.jsxs)(we.Z,{align:"middle",justify:"end",children:[(0,he.jsx)(Ce.Z,{span:9,className:oe,children:(0,he.jsxs)("label",{className:ce,children:[u("variable"),(0,he.jsx)(I.Z,{title:u("variableTip"),children:(0,he.jsx)(ke.Z,{className:de})})]})}),(0,he.jsx)(Ce.Z,{span:15,className:oe,children:(0,he.jsx)(b.ZP,{size:"small",onClick:function(){c((function(e){return[].concat(Ze()(e),[{key:(0,Ee.Z)(),variable:"",optional:!0}])}))},children:u("add")})})]}),o.length>0&&(0,he.jsxs)(we.Z,{children:[(0,he.jsx)(Ce.Z,{span:7,children:" "}),(0,he.jsx)(Ce.Z,{span:17,children:(0,he.jsx)(Ie.Z,{dataSource:o,columns:f,rowKey:"key",className:ue,components:m,rowClassName:function(){return me}})})]})]})]})},Re=(0,s.forwardRef)(Le),Be={labelCol:{span:9},wrapperCol:{span:15}},He={required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},ze=function(e){return e.AssistantSetting="Assistant Setting",e.PromptEngine="Prompt Engine",e.ModelSetting="Model Setting",e}(ze||{}),Ge=r()(r()(r()({},ze.AssistantSetting,xe),ze.ModelSetting,be),ze.PromptEngine,Re),We=function(e){var n=e.visible,t=e.hideModal,a=e.initialDialog,r=e.loading,i=e.onOk,o=e.clearDialog,c=K.Z.useForm(),d=l()(c,1)[0],u=(0,s.useState)(!1),m=l()(u,2),p=m[0],h=m[1],f=(0,s.useState)(ze.AssistantSetting),x=l()(f,2),v=x[0],j=x[1],b=(0,s.useRef)([]),Z=(0,z.ox)(),_=(0,H.qM)("chat").t,k=function(){var e=F()(S()().mark((function e(){var n,t,r,l,s,o,c;return S()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.validateFields();case 2:if(r=e.sent,!p){e.next=5;break}return e.abrupt("return");case 5:return l=(0,W.R)(r,"llm_setting."),s=null!==(n=null===(t=l.prompt_config)||void 0===t?void 0:t.empty_response)&&void 0!==n?n:"",e.next=9,(0,G.vn)(r.icon);case 9:o=e.sent,c=T()(T()({dialog_id:a.id},l),{},{vector_similarity_weight:1-l.vector_similarity_weight,prompt_config:T()(T()({},l.prompt_config),{},{parameters:b.current,empty_response:s}),icon:o}),i(c);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=(0,he.jsxs)(g.Z,{gap:16,children:[(0,he.jsx)(R,{}),(0,he.jsxs)("div",{children:[(0,he.jsx)("b",{children:_("chatConfiguration")}),(0,he.jsx)("div",{className:le,children:_("chatConfigurationDescription")})]})]});return(0,s.useEffect)((function(){if(n){var e,t,r,i=a.icon,l=[];i&&(l=[{uid:"1",name:"file",thumbUrl:i,status:"done"}]),d.setFieldsValue(T()(T()({},a),{},{llm_setting:null!==(e=a.llm_setting)&&void 0!==e?e:B.S8[B.oQ.Precise],icon:l,llm_id:null!==(t=a.llm_id)&&void 0!==t?t:Z,vector_similarity_weight:1-(null!==(r=a.vector_similarity_weight)&&void 0!==r?r:.3)}))}}),[a,d,n,Z]),(0,he.jsxs)(U.Z,{title:w,width:688,open:n,onOk:k,onCancel:t,confirmLoading:r,destroyOnClose:!0,afterClose:function(){o(),d.resetFields()},children:[(0,he.jsx)($.Z,{size:"large",value:v,onChange:function(e){j(e)},options:Object.values(ze).map((function(e){return{label:_(Q()(e)),value:e}})),block:!0}),(0,he.jsx)(y.Z,{}),(0,he.jsx)(K.Z,T()(T()({},Be),{},{name:"nest-messages",form:d,style:{maxWidth:600},validateMessages:He,colon:!1,children:Object.entries(Ge).map((function(e){var t=l()(e,2),r=t[0],i=t[1];return(0,he.jsx)(i,T()(T()({show:r===v,form:d,setHasError:h},r===ze.ModelSetting?{initialLlmSetting:a.llm_setting,visible:n}:{}),r===ze.PromptEngine?{ref:b}:{}),r)}))}))]})},Ke=t(26975),Ue=t(35293),$e=t(3012),Xe=t(61110),Qe=t(71580),Ye=t(91028),Je="chatContainer___KnZy3",en="messageContainer___HpbDk",nn=function(e){var n=e.controller,t=(0,Ye.g6)().conversationId,a=(0,Ye.WP)().data,r=(0,De.s3)(n),i=r.value,l=r.ref,s=r.loading,o=r.sendLoading,c=r.derivedMessages,d=r.handleInputChange,u=r.handlePressEnter,m=r.regenerateMessage,p=r.removeMessageById,h=(0,Qe.B)(),f=h.visible,x=h.hideModal,v=h.documentId,j=h.selectedChunk,b=h.clickDocumentButton,y=(0,De.lT)(),_=(0,De.q3)(i);(0,De.G8)();var k=(0,J.jd)().data,w=(0,De.sk)().createConversationBeforeUploadDocument;return(0,he.jsxs)(he.Fragment,{children:[(0,he.jsxs)(g.Z,{flex:1,className:Je,vertical:!0,children:[(0,he.jsxs)(g.Z,{flex:1,vertical:!0,className:en,children:[(0,he.jsx)("div",{children:(0,he.jsx)(Z.Z,{spinning:s,children:null==c?void 0:c.map((function(e,n){return(0,he.jsx)(Ke.Z,{loading:e.role===je.Cs.Assistant&&o&&c.length-1===n,item:e,nickname:k.nickname,avatar:k.avatar,avatarDialog:a.avatar,reference:(0,Ue.oI)({message:c,reference:a.reference},e),clickDocumentButton:b,index:n,removeMessageById:p,regenerateMessage:m,sendLoading:o},(0,ge.mN)(e))}))})}),(0,he.jsx)("div",{ref:l})]}),(0,he.jsx)($e.Z,{disabled:y,sendDisabled:_,sendLoading:o,value:i,onInputChange:d,onPressEnter:u,conversationId:t,createConversationBeforeUploadDocument:w})]}),(0,he.jsx)(Xe.Z,{visible:f,hideModal:x,documentId:v,chunk:j})]})},tn=(0,s.memo)(nn),an=t(7502),rn=t(5600),ln=t(46693),sn=t(98236),on=t(2072),cn="chatWrapper___LQ6YY",dn="chatAppWrapper___hrF6r",un="chatAppContent___Ri0fp",mn="chatAppCard___kPbxc",pn="cubeIcon___zAmbo",hn="chatAppCardSelected___h9j2W",fn="chatAppCardSelectedDark___K4uSc",xn="chatTitleWrapper___MXbZF",vn="chatTitle___cyXkX",jn="chatTitleContent___XsLt3",gn="chatSpin___J9mE8",bn="chatTitleCard___Pnbv0",yn="chatTitleCardSelected___A8BIt",Zn="chatTitleCardSelectedDark___isklU",_n="divider___d5TdM",kn=v.Z.Text,wn=function(){var e=(0,Ye.en)(),n=e.data,t=e.loading,a=(0,De.dd)().onRemoveDialog,i=(0,De.E$)().onRemoveConversation,o=(0,Ye.$D)().handleClickDialog,c=(0,Ye.vV)().handleClickConversation,d=(0,Ye.g6)(),u=d.dialogId,m=d.conversationId,v=(0,sn.Fg)().theme,E=(0,De.ch)(),N=E.list,S=E.addTemporaryConversation,M=E.loading,T=(0,De.XU)(),A=T.activated,F=T.handleItemEnter,O=T.handleItemLeave,V=(0,De.XU)(),q=V.activated,D=V.handleItemEnter,L=V.handleItemLeave,R=(0,De.hF)(),B=R.conversationRenameLoading,G=R.initialConversationName,W=R.onConversationRenameOk,K=R.conversationRenameVisible,U=R.hideConversationRenameModal,$=R.showConversationRenameModal,X=(0,De.HN)(),Q=X.dialogSettingLoading,Y=X.initialDialog,J=X.onDialogEditOk,ee=X.dialogEditVisible,ne=X.clearDialog,te=X.hideDialogEditModal,ae=X.showDialogEditModal,re=(0,H.qM)("chat").t,ie=(0,z.cE)(),le=ie.currentRecord,se=ie.setRecord,oe=(0,s.useState)(new AbortController),ce=l()(oe,2),de=ce[0],ue=ce[1],me=(0,rn.iV)(),pe=me.showEmbedModal,fe=me.hideEmbedModal,xe=me.embedVisible,ve=me.beta,ge=function(e){return function(n){var t,a;null==n||null===(t=n.domEvent)||void 0===t||t.preventDefault(),null==n||null===(a=n.domEvent)||void 0===a||a.stopPropagation(),ae(e)}},be=function(e){return function(n){var t=n.domEvent;t.preventDefault(),t.stopPropagation(),a([e])}},ye=function(e){return function(n){var t,a;null==n||null===(t=n.domEvent)||void 0===t||t.preventDefault(),null==n||null===(a=n.domEvent)||void 0===a||a.stopPropagation(),se(e),pe()}},Ze=function(e){return function(n){var t=n.domEvent;t.preventDefault(),t.stopPropagation(),i([e])}},_e=function(e){return function(n){var t=n.domEvent;t.preventDefault(),t.stopPropagation(),$(e)}},ke=(0,s.useCallback)((function(e){return function(){o(e)}}),[o]),we=(0,s.useCallback)((function(e,n){return function(){c(e,n?"true":""),ue((function(e){return e.abort(),new AbortController}))}}),[c]),Ce=(0,s.useCallback)((function(){S()}),[S]),Ie=function(e){var n=e.id;return[{key:"1",onClick:ge(n),label:(0,he.jsxs)(j.Z,{children:[(0,he.jsx)(f.Z,{}),re("edit",{keyPrefix:"common"})]})},{type:"divider"},{key:"2",onClick:be(n),label:(0,he.jsxs)(j.Z,{children:[(0,he.jsx)(x.Z,{}),re("delete",{keyPrefix:"common"})]})},{type:"divider"},{key:"3",onClick:ye(e),label:(0,he.jsxs)(j.Z,{children:[(0,he.jsx)(on.Z,{className:"size-4"}),re("embedIntoSite",{keyPrefix:"common"})]})}]},Ee=function(e){return[{key:"1",onClick:_e(e),label:(0,he.jsxs)(j.Z,{children:[(0,he.jsx)(f.Z,{}),re("rename",{keyPrefix:"common"})]})},{type:"divider"},{key:"2",onClick:Ze(e),label:(0,he.jsxs)(j.Z,{children:[(0,he.jsx)(x.Z,{}),re("delete",{keyPrefix:"common"})]})}]};return(0,he.jsxs)(g.Z,{className:cn,children:[(0,he.jsx)(g.Z,{className:dn,children:(0,he.jsxs)(g.Z,{flex:1,vertical:!0,children:[(0,he.jsx)(b.ZP,{type:"primary",onClick:ge(),children:re("createAssistant")}),(0,he.jsx)(y.Z,{}),(0,he.jsx)(g.Z,{className:un,vertical:!0,gap:10,children:(0,he.jsx)(Z.Z,{spinning:t,wrapperClassName:gn,children:n.map((function(e){return(0,he.jsx)(_.Z,{hoverable:!0,className:P()(mn,r()({},"dark"===v?fn:hn,u===e.id)),onMouseEnter:(n=e.id,function(){F(n)}),onMouseLeave:O,onClick:ke(e.id),children:(0,he.jsxs)(g.Z,{justify:"space-between",align:"center",children:[(0,he.jsxs)(j.Z,{size:15,children:[(0,he.jsx)(k.C,{src:e.icon,shape:"square"}),(0,he.jsxs)("section",{children:[(0,he.jsx)("b",{children:(0,he.jsx)(kn,{ellipsis:{tooltip:e.name},style:{width:130},children:e.name})}),(0,he.jsx)("div",{children:e.description})]})]}),A===e.id&&(0,he.jsx)("section",{children:(0,he.jsx)(w.Z,{menu:{items:Ie(e)},children:(0,he.jsx)(p,{className:pn})})})]})},e.id);var n}))})})]})}),(0,he.jsx)(y.Z,{type:"vertical",className:_n}),(0,he.jsx)(g.Z,{className:xn,children:(0,he.jsxs)(g.Z,{flex:1,vertical:!0,children:[(0,he.jsxs)(g.Z,{justify:"space-between",align:"center",className:vn,children:[(0,he.jsxs)(j.Z,{children:[(0,he.jsx)("b",{children:re("chat")}),(0,he.jsx)(C.Z,{children:N.length})]}),(0,he.jsx)(I.Z,{title:re("newChat"),children:(0,he.jsx)("div",{children:(0,he.jsx)(ln.Z,{name:"plus-circle-fill",width:20,onClick:Ce})})})]}),(0,he.jsx)(y.Z,{}),(0,he.jsx)(g.Z,{vertical:!0,gap:10,className:jn,children:(0,he.jsx)(Z.Z,{spinning:M,wrapperClassName:gn,children:N.map((function(e){return(0,he.jsx)(_.Z,{hoverable:!0,onClick:we(e.id,e.is_new),onMouseEnter:(n=e.id,function(){D(n)}),onMouseLeave:L,className:P()(bn,r()({},"dark"===v?Zn:yn,e.id===m)),children:(0,he.jsxs)(g.Z,{justify:"space-between",align:"center",children:[(0,he.jsx)("div",{children:(0,he.jsx)(kn,{ellipsis:{tooltip:e.name},style:{width:150},children:e.name})}),q===e.id&&""!==e.id&&!e.is_new&&(0,he.jsx)("section",{children:(0,he.jsx)(w.Z,{menu:{items:Ee(e.id)},children:(0,he.jsx)(p,{className:pn})})})]})},e.id);var n}))})})]})}),(0,he.jsx)(y.Z,{type:"vertical",className:_n}),(0,he.jsx)(tn,{controller:de}),ee&&(0,he.jsx)(We,{visible:ee,initialDialog:Y,showModal:ae,hideModal:te,loading:Q,onOk:J,clearDialog:ne}),(0,he.jsx)(h.Z,{visible:K,hideModal:U,onOk:W,initialName:G,loading:B}),xe&&(0,he.jsx)(an.Z,{visible:xe,hideModal:fe,token:le.id,form:je.qH.Chat,beta:ve,isAgent:!1})]})}},51418:function(e,n,t){t.d(n,{R:function(){return o}});var a=t(19632),r=t.n(a),i=t(1079),l=t(57557),s=t.n(l),o=function(e,n){var t=s()(e,[].concat(r()(Object.keys(i.vv)),["parameter"],r()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"llm_setting.";return Object.keys(i.vv).filter((function(n){return!e[n]})).map((function(e){return"".concat(n).concat(i.vv[e])}))}(e,n))));return t}}}]);
//# sourceMappingURL=p__chat__index.5fdd519f.async.js.map